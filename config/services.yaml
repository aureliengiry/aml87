imports:
    - { resource: services/ }

parameters:
    app_google_analytics.account_id: '%env(GOOGLE_ANALYTICS_ACCOUNT_ID)%'
    locale: 'fr'

services:
    App\Utils\Slugger:
        autowire: true

    App\EventListener\SitemapListener:
        autowire: true
        arguments:
            - '@router'
        tags:
            - { name: kernel.event_listener, event: aml_web.sitemap.generate_start, method: onGenerateSitemapEvent }

    # Service Configuration
    twig.extension.text:
        class: Twig_Extensions_Extension_Text
        tags:
           - { name: twig.extension }

    twig.extension.intl:
        class: Twig_Extensions_Extension_Intl
        tags:
           - { name: twig.extension }

    aml.twig.word_warp_extension:
        class: App\Twig\WordWarpExtension
        tags:
          - { name: twig.extension }

    aml.twig.nice_date_extension:
        class: App\Twig\PublicStatusExtension
        tags:
            - { name: twig.extension }

    aml.twig.substring_extension:
        class: App\Twig\SubstringExtension
        tags:
          - { name: twig.extension }

    fos_user.doctrine_registry:
        alias: doctrine

    ## KNP
    app.menu_builder:
        class: App\Menu\MenuBuilder
        arguments: ["@knp_menu.factory"]

    app.main_menu:
        class: Knp\Menu\MenuItem # the service definition requires setting the class
        factory: ["@app.menu_builder", createMainMenu]
        arguments:
            - "@request_stack"
        tags:
            - { name: knp_menu.menu, alias: main } # The alias is what is used to retrieve the menu

    app.breadcrumb_menu:
        class: Knp\Menu\MenuItem
        factory: ["@app.menu_builder", createBreadcrumbMenu]
        arguments:
            - "@request_stack"
        tags:
            - { name: knp_menu.menu, alias: breadcrumb } # The alias is used in the template

    ## Data Fixtures
    App\DataFixtures\PageFixtures:
        tags: ['doctrine.fixture.orm']

    App\DataFixtures\BlogFixtures:
        tags: ['doctrine.fixture.orm']

    App\DataFixtures\DiscographyFixtures:
        tags: ['doctrine.fixture.orm']

    App\DataFixtures\EvenementFixtures:
        tags: ['doctrine.fixture.orm']